name: Debug Workflow

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3
      
    - name: Debug Info
      env:
        GROQ_KEY: "${{ secrets.GROQ_KEY }}"
      run: |
        echo "=== DEBUG INFORMATION ==="
        echo "Checking ALL 6 secrets..."
        
        secrets=("SUPABASE_URL" "SUPABASE_KEY" "NEWSDATA_KEY" "WP_TOKEN" "SITE_ID" "GROQ_KEY")
        for secret in "${secrets[@]}"; do
          if [ -n "${!secret}" ]; then
            echo "✅ $secret is set (length: ${#!secret})"
          else
            echo "❌ $secret is NOT set"
          fi
        done
        
        echo ""
        echo "Total secrets loaded: $(env | grep -c 'SUPABASE\|NEWSDATA\|WP_TOKEN\|SITE_ID\|GROQ_KEY')/6"
        
    - name: Test Bot Script
      env:
        SUPABASE_URL: "${{ secrets.SUPABASE_URL }}"
        SUPABASE_KEY: "${{ secrets.SUPABASE_KEY }}"
        NEWSDATA_KEY: "${{ secrets.NEWSDATA_KEY }}"
        WP_TOKEN: "${{ secrets.WP_TOKEN }}"
        SITE_ID: "${{ secrets.SITE_ID }}"
        GROQ_KEY: "${{ secrets.GROQ_KEY }}"
      run: |
        echo "=== TESTING BOT SCRIPT ==="
        python3 github_bot.py
